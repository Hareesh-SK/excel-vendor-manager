<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Vendor Manager Add-in</title>

  <!-- Office.js API -->
  <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>

  <!-- Fluent UI CSS -->
  <link rel="stylesheet" href="https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css" />
  <link href="taskpane.css" rel="stylesheet" />
</head>

<body class="ms-font-m ms-Fabric">

  <!-- Message shown before sideload -->
  <section id="sideload-msg" class="center-section">
    <h2 class="ms-font-xl">
      Please <a target="_blank" href="https://learn.microsoft.com/office/dev/add-ins/testing/test-debug-office-add-ins#sideload-an-office-add-in-for-testing">sideload</a> your add-in to see the app.
    </h2>
  </section>

  <!-- Main App Body -->
  <main id="app-body" style="display: none;">
    <div class="container">
      <div class="header">
        <h2 class="ms-font-xxl">Vendor Management</h2>
        <button id="logoutBtn" class="ms-Button ms-Button--primary logout-btn">
          <span class="ms-Button-label">Logout</span>
        </button>
      </div>

      <!-- 🏦 Account Balance Info -->
      <div class="account-balances" style="margin-bottom: 16px;">
        <strong>Account Balances:</strong><br>
        <span id="account1-balance">Account 1: $200,000</span><br>
        <span id="account2-balance">Account 2: $200,000</span>
      </div>

      <!-- ➕ Add Vendor -->
      <div class="form-section">
        <input id="vendorName" type="text" placeholder="Vendor Name" class="ms-TextField-field" />
        <select id="paymentType" class="ms-Dropdown">
          <option value="Weekly">Weekly</option>
          <option value="Biweekly">Biweekly</option>
          <option value="On-Demand">On-Demand</option>
        </select>
        <select id="account" class="ms-Dropdown">
          <option value="1">Account 1</option>
          <option value="2">Account 2</option>
        </select>
        <button id="addVendorBtn" class="ms-Button ms-Button--primary add-btn">
          <span class="ms-Button-label">Add Vendor</span>
        </button>
      </div>

      <!-- 📋 Vendor List with Edit/Delete -->
      <h3 class="ms-font-l">Vendor List</h3>
      <ul id="vendorList" class="ms-List vendor-list"></ul>

      <!-- 🚀 Action Buttons -->
      <div class="action-buttons" style="margin-top: 20px;">
        <button id="runScheduledPaymentsBtn" class="ms-Button ms-Button--primary">
          <span class="ms-Button-label">Run Scheduled Payments</span>
        </button>
        <button id="payNowBtn" class="ms-Button ms-Button--primary">
          <span class="ms-Button-label">Pay Now (On-Demand)</span>
        </button>
      </div>

      <!-- 📜 Payment History -->
      <div class="payment-history-section" style="margin-top: 20px;">
        <h3 class="ms-font-l">Payment History</h3>
        <ul id="paymentHistoryList" class="ms-List"></ul>
        <button id="exportBtn" class="ms-Button ms-Button--default">
          <span class="ms-Button-label">Export to Excel</span>
        </button>
      </div>

      <!-- ⏳ Pending Payments -->
      <div class="pending-section" style="margin-top: 20px;">
        <h3 class="ms-font-l">Pending Payments</h3>
        <ul id="pendingPaymentsList" class="ms-List"></ul>
      </div>

      <!-- ✏️ Edit Vendor Modal -->
     <div id="editVendorModal" style="display:none;">
  <input id="vendorNameInput" placeholder="Vendor Name" />
  <input id="paymentTypeInput" placeholder="Payment Type (Weekly, Biweekly, On-Demand)" />
  <input id="accountInput" placeholder="Account (1 or 2)" type="number" />
  <button onclick="saveEditedVendor()">Save</button>
</div>


    </div>
  </main>

</body>

</html>
